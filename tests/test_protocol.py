import pytest

from syma import checksum

_CAPTURED_PAYLOADS = """
436d640001001200010404000a000000802f80da20202020004a0d
436d640001001200010404000a000000803d80662020202000b00d
436d640001001200010404000a0000008043805b20202020006dc5
436d640001001200010404000a000000804c80ba20202020004b0b
436d640001001200010404000a000000804e806620202020007deb
436d640001001200010404000a00000080688048202020200075df
436d640001001200010404000a000000806c8080202020200041e7
436d640001001200010404000a0000008080805620202020002bbb
436d640001001200010404000a00000080808063202020200038d5
436d640001001200010404000a00000080808071202020200046f1
436d640001001200010404000a0000008080807f2020202000540d
436d640001001200010404000a000000808080802020202000550f
436d640001001200010404000a000000808080802020202000550f
436d640001001200010404000a0000008080808020202020085d1f
436d640001001200010404000a000000808080bc20202020009187
436d640001001200010404000a000000808080cd2020202000a2a9
436d640001001200010404000a000000808080cf2020202000a4ad
436d640001001200010404000a00000080b480c32020202000ccfd
436d640001001200010404000a00000080b88058202020200035ff
436d640001001200010404000a00000080c7808020202020009c9d
436d640001001200010404000a00000080c8807f20202020000c0d
436d640001001200010404000a00000080ca808020202020009fa3
436d640001001200010404000a00000080d580802020202000aab9
436d640001001200010404000a00000080ea807f2020202000ea0d
436d640001001200010404000a00000080eb802b202020200015e5
""".strip().split()
CAPTURED_PAYLOADS = [bytes.fromhex(p) for p in _CAPTURED_PAYLOADS]


@pytest.mark.parametrize("payload", CAPTURED_PAYLOADS)
def test_checksum(payload):
    assert payload[-2:].hex() == checksum(payload[:-2]).hex()
